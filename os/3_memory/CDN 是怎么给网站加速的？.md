你心血来潮，搞了个博客网站，起初网站的架构很简单，就是一台服务器。

![华为文案1.drawio](/Users/xiaolin/Downloads/华为文案1.drawio.png)

你勤勤恳恳在博客上分享了很多干货文章，文章包含大量了你自己画的图片，还贴心了录制一些视频讲解。

不经意间，有位读者发现了你的博客文章写的很赞，解决了他很多知识的盲点，于是他开始向他周围朋友推荐你的站点，就这样一传十，十传百。

![华为文案1.drawio (1)](/Users/xiaolin/Downloads/华为文案1.drawio (1).png)

随着越来越多的读者的访问，你的服务器的压力也开始慢慢增大，时常有读者跟你反馈「什么破网站，图片和视频压根没有显示出来」。

此刻的你，喜忧参半，你开心的是博客得到了很多人的认可，你伤心的是得掏钱升级服务器了。

你登陆上了服务器，发现服务器的带宽流量经常跑满。你开始分析自己网站的特点，都是静态资源，比如图片、视频、网站中的文件（html、css、js）等等。

很快，你就想到给自己网站加个 **CDN 服务**，给网站加加速。

### CDN 是怎么给网站加速的？

在没有使用 CDN 服务之前，用户通过域名访问你的网站时，DNS 服务器最终会返回源服务器的地址，这样用户请求的资源都是从你的源服务器上获取，如果你的网站中大型的静态资源特别多，比如图片、视频等。那么随着用户量的增加，源服务器的带宽自然扛不住这些流量，反应到用户的感觉就是网站卡。

当用户访问使用 CDN 服务的网站时，本地 DNS 服务器通过 CNAME 方式将最终域名请求重定向到 CDN 服务，用户就不直接访问源服务器。

CDN 通过一组预先定义好的策略(如内容类型、地理区域、网络负载状况等)，将当时能够最快响应用户的 CDN 节点 IP 地址提供给用户，使用户可以以最快的速度获得网站内容。

使用 CDN 后的HTTP请求处理流程如下：

![img](https://support.huaweicloud.com/productdesc-cdn/zh-cn_image_0000001129063959.png)

HTTP请求流程说明：

1. 用户在浏览器输入要访问的网站域名www.example.com，向本地DNS发起域名解析请求。

2. 本地DNS检查缓存中是否有www.example.com的IP地址记录。如果有，则直接返回给终端用户；如果没有，则向网站授权DNS查询。

3. 网站DNS服务器解析发现域名已经解析到了CNAME：www.example.com.c.cdnhwc1.com。

4. 请求被指向CDN服务。

5. CDN对域名进行智能解析，将响应速度最快的 CDN 节点 IP 地址返回给本地DNS。

6. 用户获取响应速度最快的 CDN 节点 IP 地址。

7. 浏览器在得到最佳节点的 IP 地址以后，向 CDN 节点发出访问请求。

   - 如果该IP地址对应的节点已缓存该资源，节点将数据直接返回给用户，如图中步骤 7 和 8，请求结束。
   - 如果该IP地址对应的节点未缓存该资源，节点回源请求资源。获取资源后，结合用户自定义配置的缓存策略，将资源缓存至节点，如图中的北京节点，并返回给用户，请求结束。

   

### 选择哪个厂商的 CDN？

了解完 CDN 的工作原理后，你开始看国内各大厂商的 CDN 服务，有选择纠结症的你，不知道选择哪一家。

要我说的话，**华为 CDN** 特别靠谱。

华为在全球有丰富的节点。**在中国大陆境内有 2000+ 加速节点**，这是什么概念？相当于覆盖国内的所有省份、自治区、直辖，不管用户在国内的任何地方，都能享有加速访问网站的效果。

海外的朋友也能享有加速的效果吗？当然有的，华为 CDN **在中国大陆境外有800+加速节点，全网带宽输出能力不低于 150 Tbps**。

![img](https://support.huaweicloud.com/productdesc-cdn/zh-cn_image_0000001129062416.png)

这么多加速节点，再加上与多家主流运营商合作，不管用户在哪个地方，都能将请求精准调度至最优边缘节点，精准调度率高达 99 %。

> 加速的问题解决了，我担心我的网站资源会不会被盗链？

这个不用担心。

华为云还为咱们提供安全可靠的 CDN 服务，支持全网 HTTPS 安全传输，网站防盗链等高级安全控制功能，再也不怕资源被盗链啦！

> 要是我网站加入了最新内容， CDN 没有源服务的资源，同一时间有大量的 CDN 服务回源服务器请求资源，怎么办？

小问题，可以将你最新的内容进行「缓存预热」。

所谓的缓存预热，就是你提交预热请求后，源站会主动将对应的资源缓存到 CDN 节点，当用户首次请求时，就直接从 CDN 节点缓存中获取到最新的请求资源，无需再回源拉取。

如果你更新了内容，想用户能看到更新后的内容，可以华为 CDN 提交「缓存刷新」请求，接着 CDN 节点的缓存内容就会被强制过期，当用户向 CDN 节点请求资源时，CDN 回直接回源站拉取对应的资源返回给用户，并将其缓存。

以上这些操作，直接在华为 CDN 后台即可轻松配置。

因此，用上华为 CDN 后，等同于给你的博客网站加上四个强劲的 buff，分别是**稳定、安全、可靠、快速**。

### 华为云 CDN 应用场景有哪些呢？

主要有四大应用场景：**静态网站加速、文件下载加速、视频点播加速、全站加速**。

##### 静态网站加速

适用于有加速需求的网站，包括门户网站、电商平台、资讯APP、UGC应用（User Generated Content，用户原创内容）等。

CDN 网络能够对加速域名下的静态内容提供良好的加速服务。支持自定义缓存规则，用户可以根据数据需求设置缓存过期时间，缓存格式包括但不限于zip、exe、wmv、gif、png、bmp、wma、rar、jpeg、jpg等。

##### 文件下载加速

适用于使用HTTP/HTTPS文件下载业务的网站、下载工具、游戏客户端、APP商店等。

现在越来越多的新业务需要通过网络对客户端软件进行实时更新，包括APP更新，手游更新等，传统的下载类业务也需要支持更多的文件数量和更大的文件，如果所有的请求都通过源站服务器来处理，服务器和网络会成为很大的瓶颈，导致下载体验变差。

使用CDN下载加速可以将下载量大的内容分发到各地的CDN节点，有效减轻源站的压力，同时保证了客户端高速下载的需求

##### 点播加速

适用于提供音视频点播服务的客户。例如：在线教育类网站、在线视频分享网站、互联网电视点播平台、音乐视频点播APP等。

传统的点播服务会加大服务器的负载，并消耗巨大的带宽资源，同时又无法保证终端用户访问时需要的高速体验，CDN点播加速可以提供快速、稳定和安全的点播加速服务，通过分布在各个区域的CDN节点，将音视频内容扩展到距离用户较近的地方，随时随地为用户提供高品质的访问体验。

##### 全站加速

上面提到的三个应用场景都属于静态内容加速，全站加速就适用于静态+动态内容加速。适用于含较多动态资源请求（如asp、jsp、php等格式的文件）的网站。

全站加速融合了动态和静态加速，用户请求资源时，静态内容从边缘节点就近获取，动态内容通过动态加速技术智能选择较优路由回源获取。CDN全站加速有效提升动态页面的加载速度，避开网络拥堵路由，提高访问成功率，实现网站整体加速与实时优化。

![img](https://support.huaweicloud.com/productdesc-cdn/zh-cn_image_0170806896.png)

### 怎么购买华为 CDN？

华为云最近推出一款「**CDN中国大陆混合流量包**」，**单价低至 0.058元/GB**，简直就是性价比首选。

网站地址：https://activity.huaweicloud.com/cdn_video.html

![image-20220319171711799](/Users/xiaolin/Library/Application Support/typora-user-images/image-20220319171711799.png)





